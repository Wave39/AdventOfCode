//
//  Puzzle_2023_12.swift
//  AdventOfCode
//
//  Created by Brian Prescott on 12/4/23.
//  Copyright Â© 2023 Wave 39 LLC. All rights reserved.
//

// Big assist to the C# code at https://pastebin.com/djb8RJ85
// and to ChatGPT for helping me convert it to Swift

import Foundation

public class Puzzle_2023_12: PuzzleBaseClass {
    public func solve() {
        let part1 = solvePart1()
        print("Part 1 solution: \(part1)")

        let part2 = solvePart2()
        print("Part 2 solution: \(part2)")
    }

    public func solvePart1() -> Int {
        solvePart1(str: Puzzle_Input.final)
    }

    public func solvePart2() -> Int {
        solvePart2(str: Puzzle_Input.final)
    }

    private func solvePart1(str: String) -> Int {
        var part1: Int64 = 0
        var cache = [String: Int64]()

        let input: [String] = str.parseIntoStringArray()

        for line in input.map({ $0.split(separator: " ") }) {
            let springs = String(line[0])
            let groups = line[1].split(separator: ",").compactMap { Int(String($0)) }

            part1 += calculate(springs: springs, groups: groups)
        }

        func calculate(springs: String, groups: [Int]) -> Int64 {
            let key = "\(springs),\(groups.map { String($0) }.joined(separator: ","))"

            if let value = cache[key] {
                return value
            }

            let value = getCount(springs: springs, groups: groups)
            cache[key] = value

            return value
        }

        func getCount(springs: String, groups: [Int]) -> Int64 {
            var springs = springs
            var groups = groups

            while true {
                if groups.isEmpty {
                    return springs.contains("#") ? 0 : 1
                }

                if springs.isEmpty {
                    return 0
                }

                if springs.hasPrefix(".") {
                    springs = springs.trimmingCharacters(in: CharacterSet(charactersIn: "."))
                    continue
                }

                if springs.hasPrefix("?") {
                    let option1 = calculate(springs: "." + String(springs.suffix(from: springs.index(after: springs.startIndex))), groups: groups)
                    let option2 = calculate(springs: "#" + String(springs.suffix(from: springs.index(after: springs.startIndex))), groups: groups)
                    return option1 + option2
                }

                if springs.hasPrefix("#") {
                    if groups.isEmpty {
                        return 0
                    }

                    if springs.count < groups[0] {
                        return 0
                    }

                    if springs.prefix(groups[0]).contains(".") {
                        return 0
                    }

                    if groups.count > 1 {
                        if springs.count < groups[0] + 1 || springs[springs.index(springs.startIndex, offsetBy: groups[0])] == "#" {
                            return 0
                        }

                        springs = String(springs.suffix(from: springs.index(springs.startIndex, offsetBy: groups[0] + 1)))
                        groups = Array(groups.dropFirst())
                        continue
                    }

                    springs = String(springs.suffix(from: springs.index(springs.startIndex, offsetBy: groups[0])))
                    groups = Array(groups.dropFirst())
                    continue
                }

                fatalError("Invalid input")
            }
        }

        return Int(part1)
    }

    private func solvePart1_naive(str: String) -> Int {
        var retval = 0
        let arr = str.parseIntoStringArray()
        for line in arr {
            //print(line)
            let arr2 = line.parseIntoStringArray(separator: " ")
            //let x = arr2[0].consecutiveCharacterCounts()
            let damagedSprings = arr2[1].parseIntoIntArray(separator: ",")
            let damagedTotal = damagedSprings.reduce(0, +)
            //print(x)
            //print(damagedSprings, damagedTotal)
            let unknowns = line.filter { $0 == "?" }.count
            let damaged = line.filter { $0 == "#" }.count
            //print(unknowns, 2 << unknowns)
            let unknownIndicies = line.indices(of: "?")
            //print(unknownIndicies)
            for b in 0..<(2 << (unknowns - 1)) {
                let bStr = String(b, radix: 2).padLeft(with: "0", toSize: unknowns)
                if bStr.filter({ $0 == "1" }).count == (damagedTotal - damaged) {
                    //print(bStr)
                    var testStr = line
                    for idx in 0..<unknowns {
                        if bStr[idx] == "0" {
                            testStr = testStr.replace(index: unknownIndicies[idx], newChar: ".")
                        } else {
                            testStr = testStr.replace(index: unknownIndicies[idx], newChar: "#")
                        }
                    }
                    //print(testStr)
                    let counts = testStr.consecutiveCharacterCounts()
                    let testArr = counts.filter { $0.0 == "#" }.map { $0.1 }
                    if testArr == damagedSprings {
                        retval += 1
                    }
                }
            }

            //print("")
        }

        return retval
    }

    private func solvePart2(str: String) -> Int {
        var part1: Int64 = 0
        var part2: Int64 = 0
        var cache = [String: Int64]()

        let input: [String] = str.parseIntoStringArray()

        for line in input.map({ $0.split(separator: " ") }) {
            let springs = String(line[0])
            let groups = line[1].split(separator: ",").compactMap { Int(String($0)) }

            part1 += calculate(springs: springs, groups: groups)

            let repeatedSprings = Array(repeating: springs, count: 5).joined(separator: "?")
            let repeatedGroups = Array(repeating: groups, count: 5).flatMap { $0 }

            part2 += calculate(springs: repeatedSprings, groups: repeatedGroups)
        }

        func calculate(springs: String, groups: [Int]) -> Int64 {
            let key = "\(springs),\(groups.map { String($0) }.joined(separator: ","))"

            if let value = cache[key] {
                return value
            }

            let value = getCount(springs: springs, groups: groups)
            cache[key] = value

            return value
        }

        func getCount(springs: String, groups: [Int]) -> Int64 {
            var springs = springs
            var groups = groups

            while true {
                if groups.isEmpty {
                    return springs.contains("#") ? 0 : 1
                }

                if springs.isEmpty {
                    return 0
                }

                if springs.hasPrefix(".") {
                    springs = springs.trimmingCharacters(in: CharacterSet(charactersIn: "."))
                    continue
                }

                if springs.hasPrefix("?") {
                    let option1 = calculate(springs: "." + String(springs.suffix(from: springs.index(after: springs.startIndex))), groups: groups)
                    let option2 = calculate(springs: "#" + String(springs.suffix(from: springs.index(after: springs.startIndex))), groups: groups)
                    return option1 + option2
                }

                if springs.hasPrefix("#") {
                    if groups.isEmpty {
                        return 0
                    }

                    if springs.count < groups[0] {
                        return 0
                    }

                    if springs.prefix(groups[0]).contains(".") {
                        return 0
                    }

                    if groups.count > 1 {
                        if springs.count < groups[0] + 1 || springs[springs.index(springs.startIndex, offsetBy: groups[0])] == "#" {
                            return 0
                        }

                        springs = String(springs.suffix(from: springs.index(springs.startIndex, offsetBy: groups[0] + 1)))
                        groups = Array(groups.dropFirst())
                        continue
                    }

                    springs = String(springs.suffix(from: springs.index(springs.startIndex, offsetBy: groups[0])))
                    groups = Array(groups.dropFirst())
                    continue
                }

                fatalError("Invalid input")
            }
        }

        return Int(part2)
    }
}

private class Puzzle_Input: NSObject {
    static let test = """
???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1
"""

    static let final = """
?.???#????? 1,3,1
..???#??????#?????? 3,6
???#??.????. 4,1,1,2
??#?????????#?##?? 4,4,2,4
??..???.????#??? 2,1,6
?#???#.????.??. 2,1,1,2,2
#??.???### 1,1,5
?????#?###?#???.???# 3,9,1,1,1
###????.??#####.??? 6,5
.?##???.#? 3,2
?.?#??#??..# 3,1,1
?.?????.?????? 1,3,1,3
.#.?#?.???. 1,3,2
??#?#????#..???????? 5,1,4,2
??.?#??##?? 1,1,2
?????.????##?#? 1,1,7
?#?#??..#?. 5,2
???.#???.????#???? 1,1,1,1,6,1
?.??##?#????? 6,3
??..??#?#????????.# 1,1,1,1,4,1
??????##???????? 2,4,6
?##..?##?##??.?#.? 2,8,1,1
???#??.?###.?????. 3,3,2
..#?...?#?? 2,4
#?.?#.?.???#?#? 2,1,1,1,4
???##?.??#?.?? 6,1,2,1
.#????.??? 1,2
?.?..##??#?#?#??.. 1,1,2,4,1,1
?#??#?#??#?#?.??#?? 11,4
??#?##??##???? 1,8
???#??.#?? 2,1,2
??#???#??.#.?#??#??? 3,2,1,8
????#???.???# 1,1,2,2
??#?.????? 4,2
???????..?##???.? 4,6
???.??????.??? 1,1,6,2
???.#???????.#??? 1,1,2,1,3
?.#????????? 1,1,1,1
?#???????????.??#.?. 5,1,1,1,1,1
????##?##?#???#?#??. 1,10,2,1,1
???#?.?.?? 5,1,1
.????#??#.#??# 1,4,4
?????..??##.?..?? 1,4
#?#???#?##??.??????? 1,10,1,1
??.????#????#????? 1,1,12
#?.#.???###???#??? 1,1,1,6,1,2
?.???.?????????#.?? 1,4
?##?###?????##.#??#? 7,3,1,2
???#?????? 3,1
.?#????#?#?.#???#?? 7,1,2,2
.?#??.??.####.#? 1,2,4,1
?.?.?????##.?.?.#.? 1,1,4,1,1,1
.????.??#??????## 1,3,5
?.###???????? 1,3,2
????????????. 7,2
???.?###.##???#?.?? 3,4,6,2
??#?#?###??????.?? 7,3
#.??#????? 1,1,3
.??#?#?.??.?#? 3,2,1,3
?.?#????.?. 2,1
???.?#??#????? 2,6,1
#??????##????? 1,1,8
???.##..??#?#?#.??? 1,2,1,1,3,1
???.?????#??????? 2,6,2,3
????#???#??#??.??#?? 2,9,3
??????????.?#? 3,1,3,3
??#?#????#? 1,1,4
#??##???#???? 10,1
#?.??????#???.# 2,7,1,1
??#?.???#??????. 1,8
.?##?????#?? 3,3
?....??????.#.?. 1,5,1,1
.???#.????? 2,1,2
??#??????#?#????##? 1,16
##?.#?????#???.#??? 3,2,3,2,2,1
???##???##????.???? 10,3
??.???.???#?.?? 2,2,3
.??#????..???# 5,1,4
?#?.?#?#??#?#???? 1,12
.?#??.??#?? 2,3
?#?#???#????? 4,4,2
.???#..????#? 1,5
?##?#??????..???? 8,1,1
#?##??.?#.#???##???? 6,1,1,6
#??.????#?? 1,1,6
#???#????.??????#??? 1,3,1,1,7,1
?.?#?#?.?#????. 4,1,2
##??.#?????.# 2,1,2,1
?.????????##??# 6,4,1
?..#....?# 1,1,1
?##??.??#??#? 4,2,3
??#??????????? 3,4,3
.#???.???????? 3,5,1
???.?.????????.? 1,5
????##????? 3,2,2
???##?##???#??????# 10,2,1,2
?#?.???????#? 3,1,1,1
???#????#??# 1,2,4
?.??#..??? 1,3,2
?.??#???.??? 3,1
??????#??## 1,6
.?#?.#???? 2,1,1
?????????##.? 1,7
?..?.?.?#??? 1,4
.?#??#????????#.#? 3,1,2,1,1,1
?.???.?#??.. 1,2
?#?#????.##?##???# 4,2,5,1,1
?#.#??#?#?#?? 1,8
##?.????##? 3,6
?????????? 1,2,1
??.#??.#??. 1,1,1
?#??#.??#???.?#. 5,3,1,1
??##?#?????. 5,2
?.??#?????? 3,2
#????????? 1,7
??.#?..???#? 1,5
##???##?#?? 2,4,2
?#?.??#??.?.? 2,3,1
???##???.??# 1,5,1,1
?#??.?.?#.????# 1,1,1,3,1
?.?.#.?????????#.# 1,1,1,6,1,1
??#?????#???##??#?## 5,12
?#???#?????. 7,2
???.?#???? 1,2
???.??????.?#??#?? 2,1,1,2,1,1
???#?.#?##? 2,1,5
?#??.??.?? 3,2,1
??#.???#.???. 1,2,1,2
??.??????????##..??? 4,7,2
???#??.##?????.. 1,1,7
???#????#..#?.??? 6,1,2,1
????????#? 1,4,1
###?????.####.?? 5,4
?#?##??#.??. 7,1
?#????????????#?? 2,6,1,1,1
.?#?????#??? 2,5
??#????#####?#.# 4,6,1,1
?????#???#??? 2,6,1
.?..????.#?? 1,1,1,3
..?????#?#?###?. 1,10
?.##??#??.??.???#? 2,2,1,4
???????.#????#?#?.# 1,1,1,8,1
???#?.??.??? 5,1,1,1
??.?#???#?????.? 1,2,5,1,1
.??.???#?##? 1,1,1,2
.?#.?#?????# 1,1,3,1
#?##?????###???????. 1,2,1,7,1,1
.##???#.??#??.? 3,2,1,3,1
??###.??.?????? 5,1,1,2,1
?.??####??????.#???? 7,2,5
?????#?.?? 3,2,1
???????.??#?? 1,2
.?.???#?#??.? 1,1,5,1
????.??.##???. 2,2
??.#????##???? 1,1,1,6
?.???##????.??. 1,1,5,2
????.??????##?#??? 2,11
??????#?####???# 12,1
?#???.???# 3,1,3
?????????#?#? 1,2,6
???.??#.?. 2,3
..#..?#?.??.# 1,3,1,1
?#?#???#.#?#.?? 3,3,1,1,1
?#?##?????? 6,3
.?#???#.?.?##?#????? 2,1,1,9
??.??#???## 1,3,4
.#?.?????..?#??? 2,4,5
?#????#.??? 3,1,1
??.#???#?###????## 1,1,13
???.###???#???.#. 2,7,1,1
.????.?.?????? 3,1,3
#???????????..#.. 4,1,1,1,1
?.?.##??.??.????. 1,1,3,2,4
???????.????? 4,1,1,1
??#??#.????.?? 6,3,1
???#?????##????##?? 1,3,1,10
?#???#????.?##?. 1,1,2,2
??????#?.???#.? 1,3,1,2
##???????? 5,3
?#?###?.?.???????# 6,1,1,1,1
???????.#?? 1,1,2
.????.??#?.?#.??.. 2,2,1
??????..?.?.??.. 4,1,1
#???#??#??????##? 2,1,10
??????..#.???. 1,1,1,3
??????????#????# 6,3,1,1
??.?????.? 2,2,1
?.?????#???.??# 3,5,2
#?#.???#??..?#? 1,1,1,3,3
??.??..??#.???##???? 1,2,1,1,6,2
?.??##?##?.?.??#??? 8,4
#????##????????#?# 1,1,2,4,4
#?#.???#?.?????? 3,2,1,6
#??????????..#??? 2,5,3
????.??.??.#.#?#?? 3,1,2,1,1,3
???#?##??? 6,2
????????.#?? 1,1,1,2
##?.#????#?#?. 2,1,2,1
??#??????#??#?. 1,1,1,2,5
????..???? 1,1,3
.?..?#.?????.?? 1,1
.?##??.#..?????#? 2,1,6
??.?#..???? 1,1,2
#??#??#???????????? 4,1,2,2,2
..???.??????#?? 1,3,4
?.#??.??????#? 1,6
#??????#???##???? 1,2,4,4,1
??.??????? 1,1,3
.???#???##????#? 1,6,4
??#???.????#. 3,1,4
#?.??????? 1,1,1
??##???????????????# 1,4,1,1,6,1
#?????##????????? 1,1,5,2
##?????#?##?#?.? 2,10
##???#.?#.?##?. 3,1,1,3
??#?.????? 3,1
.?#.???.?#?#???#??? 2,1,1,6,4
#???#?#??????. 1,3,1,2
.??????.?.??. 1,3,1,1
.??##????.? 5,1
..??.???##??????..? 1,5,1
.#..???????? 1,3,1
??.???.???###.??.? 2,6
?##????#?#..?#? 3,3,1,3
??#.??#.???#? 2,3,5
?#???#?????##????#.? 5,1,5,1
??.???###?????????? 8,3
?##?#?#?...#????#??? 7,1,5
???#???#??#.????? 1,6,2,4
?.?#???##.? 4,2
.?.????####. 1,5
?.#??.?#?. 3,1
..?#??.??.?#?#???? 3,6
?.??????#? 1,7
?.????.??.?####???? 1,2,1,1,6,1
?#..#????????? 1,1,3,1
?#????##.???#???? 3,3,4
.???.?#?..# 1,2,1
.##?#?###??.??? 9,3
#?.????#??###??##? 1,5,5,2
?????????#. 6,1
#?????.#?. 5,2
??????????? 2,3
.??#.???....#.? 3,1,1,1,1
??.??#??????.???? 1,4,1,3
.?#.#?#???##???#. 1,1,1,1,6
?#..?.?.??? 2,1
?????.?#?. 1,1,2
??#?#??????#???? 8,2
???..???##?????.? 2,6,1,1
?.????..??#?.? 1,3
???.??.?#?#.? 1,1,3,1
?#???###?##?? 1,7
??.####?????#.... 6,1
???#?.#?.?? 2,1,1
?.???#??#?#.????? 1,4,1,1,3
?.??.????????. 1,4,1
.?#????#???.? 4,2,1
#?#.??.?.?###?????.? 1,1,1,1,3,3
?#??.??##??#?##?#? 4,8,2
.?????.#?? 1,1
??..#?.??????#? 2,1,7
??##????##?.?? 1,9
?#????#?#?.?.?? 4,1,2,1,1
?#???#??.????#? 1,4,1,2
??.????#?. 2,2,2
??????#.???##??? 4,1,1,3,1
?##??##?.???.##?. 2,3,1,2
.????????#?. 5,1
.??.????????#? 1,2,5
??.??##?#?.????????? 1,1,2,1,8
#?###?????# 5,1,2
#?.???#..? 1,3
.??????.#?.#.? 4,1,1
?.??.???#??#? 2,1,2,1
????..???##?????? 1,5
??#??????.????#.. 7,5
?###???#?.?.???## 7,4
??.?.?????.?? 1,3
???#??????????? 1,1,2,1,1
.??#.????? 2,4
.???????.?#? 3,1,1
#.?.#??#???? 1,2,1,2
???#??##??????#??.?? 11,1,2,1
#???????.?#?..?#? 3,1,1,3,1
?#?#.?.????.??? 1,1,1,1,1
???.#????????? 1,9
???##??????.?#???# 9,1,1,1,1
?..?????????.?...? 1,2
????.#?#?#? 2,1,5
???#????.?#???.??? 1,2,1,3,1,2
???.##??????.?#? 1,5,1,1
..????????#? 3,3
?.?#??#.??????.#? 1,4,1,1,2
?.???.??.? 1,1,1
??????##?#?#?.????# 8,4,2,1
??#?#?????#. 7,2
.??#???.?.#??????##? 2,1,9
.?##??#????.? 2,5
.?.?##?.#.?.##.?#? 1,2,1,1,2,2
?????#???#?. 1,6
.#???????#????#?##?# 2,11,2,1
???#???????.#??.?? 1,5,2,2,1
????????.????##???#? 2,2,8
??????###?#?????#??# 8,1,6,1
???#?.??###.?? 1,1,4,1
??.???#???##??.#?#?# 1,10,1,1,1
??#?#?????#?????? 3,3,1,1,4
..?????#?.#. 3,1,1
??????????.??#????# 3,4,2,3
?..?#?.??.#???#?#?. 1,3,1,3,1,2
.???#???#?? 2,3
?.?#?..?#?? 1,1,2
???????#?? 1,1,3
???.??...? 3,1
??##.??.?????#.????? 2,6
??#???#?#???.? 1,8
?##??????? 6,2
????????????#?#?? 5,4,1
#.????#?.?. 1,1,2
???#??.?#. 1,3,2
#?.???#?????.# 1,1,7,1
?###..??.??? 4,1,2
#??????..#?? 3,1,1
???#???#?#?#???.?? 1,13
???????#??????## 5,1,6
.??.???.???###. 2,1,5
#.#???#??#?#?????# 1,1,8,1,2
?..????##?.#? 1,1,4,1
????###?????#??? 1,10,1
????##?????? 2,2,4
.?????????##?? 1,9
.?.?##.?#?#? 3,3
..??##?##?#?#??? 4,7
????##????#??????? 4,4
#??#??#??? 4,4
??.??????#??##?. 1,1,6
?.??#?????.#??#? 1,3,1,1,1
.??#????#????## 8,1,2
.?##..???..? 2,1
??.??????? 1,2,1
?.?#?????#?#?.#..?.? 1,11,1,1,1
??????.?.??? 4,2
..????????? 3,4
???#?#?#?.?#.?? 9,2,1
??##?##??#? 6,1
?.?.?#???#. 1,1,5
???#????#???##???.. 9,4
?##???#??? 3,1
.?#?.?.#??? 1,3
????????????#?. 6,1,2
.##?#??#?#?# 9,1
?#?#.?..?. 3,1
#????#.?.??? 2,1,2
??..#????..??##? 2,5,3
??##?#??.??#???##?.? 6,1,5
??????..?? 2,1
#??#?.????#?.#?.? 1,1,5,1,1
???##???.#?#?? 5,3
??#?#??.????? 4,1,1
.#??#?#??#.?.?##?? 6,1,1,4
.?..????.??#? 2,3
#???#??###.#? 5,3,1
?#?#??###?????#? 10,2
??.?#??#.?..????.??? 1,5,1
#??#.#??#?????.?#?? 2,1,4,3,2,1
???##??...????????#? 1,5,1,2,5
?#?????????????.???# 4,4,1,3
.#?????##?????# 8,1,3
.??##??????##?? 4,3,2
?????#.?#?.?????.# 1,1,1,2,2,1
???????.?#? 1,1,2
??#.???#????# 3,1,1,3
#?????#??? 1,3,3
??.??#?##.#??? 6,3
?????.?????. 1,2,2,1
?????.????#?????? 1,1,4,1
??##?????.?????##?? 1,5,1,2,5
.?????#?#?#.?.#.# 8,1,1,1,1
???#?#?????##???.?? 16,1
????.#????.????#?? 1,3
???#??.#??? 4,2
??.#.?#?#?????# 1,1,5,1,2
#?#???#.???????#???? 1,5,1,3,3
.?#????#???????? 1,1,1,1,4
???.???#??????## 1,1,9
#??.?##?.???#? 1,3,5
???.??.??..??? 3,1,1,2
#????.#.#? 3,1,1
?#?##?#??#?..?????## 9,2,1,2
????.#??#???.????? 1,1,2,4,1,2
#??..??.????? 3,1,1,1
#???#??#????? 3,1,6
??###??#??#?##???#. 3,2,8
??#???.?#????? 3,5
????##??.????#?#? 1,3,5,1
#?.?....?#. 2,1,1
?.##??##???#????#? 11,4
?#?..#?.???#?#?##. 3,1,7
?????.?.#.?.?. 5,1,1,1
??#???.#??? 4,2
?#..???#?#?##??#?. 1,10
#?..??????? 2,5
???##??????. 1,2,1,1
#??.???????????#??? 1,1,1,7,2,1
??.???##??#???? 1,1,3,3,1
?####?#?#?????.???? 12,1,1
???##?##?.#?.??#?# 1,6,2,5
???#.?.### 2,3
?#.#??.#?#??? 1,3,3
???#.?##?.?.#????? 1,1,4,1,1,3
?.#???#.?.#?.????? 1,5,1,1,4
???#???#?????.???.? 3,2,2,1,1,1
??#??.??####?.#?.?. 1,1,6,1,1
?.????#????#?.??#?# 1,1,5,2,5
?????.?????#?. 2,1,2
?.?.?#?????.????.?.? 2,1
?##???????#?????? 2,2,6
????#?#???#??#? 11,2
.?#?#...#?##????? 4,1,4
?#?.?????###???.??? 3,10,1
#?##????.#.????##?? 8,1,6
???????????? 1,4,4
.?..?.#?#??####??# 1,1,12
??#??#????##??#.???? 3,10,2
?????????#????#?.?? 1,4,4,1,1
?#????????????. 1,1,6,1
#?????##??? 8,1
?..?.?#??#??#??. 1,1,9
.?????#..?? 2,2,1
?#???????????.? 7,2
?.??.?#????#? 1,1,7
?????##????. 2,4
???????..#?.? 3,2
?????#.????.?.? 6,2,1,1
#.?.#??.??? 1,3
???????????##?????. 1,1,8,1
?????.#.??#?? 1,1,1,4
????.#?????? 3,1,1,3
????#????##???? 1,9,1
?.???#?..#??????#? 4,4,2
?#????.??#??#???.? 2,1,4,4,1
.#??????#?#?##?? 2,11
.?.???????#??? 1,1,2,2
#?.??..??.?.#??? 2,2,2,2
?..#?.??#???#.?##?? 1,5,4
?#????#??#?????#???. 4,1,1,4,1
??.??#???.?.???#.. 1,2,1,1,4
.???????#?? 1,5
???#?#?????? 2,4,1
?.??#??#.??? 1,1,1,1
?.?#...??#??#?. 2,1,5
.??#??.???? 3,1
#.??.???#?? 1,4
?????.?#?#???? 1,5
?#.?#???#.. 1,5
#????????????.????? 1,1,1,4,2,2
?#?.??##????????? 2,5,2,1
???.?????.????? 3,1,5
.?.?????#???.???? 1,9,2
??????#??#??.#?? 1,8,2
?#???#????. 1,2,2
?#???#??.?#??#???? 6,2,3
#??????#???.?.?? 3,4,1,1,1
????.??.?.?????###?# 3,1,1,8
#.?.?#?????.?????.. 1,2,1,2,1,3
.?.?##???????? 7,1
?#?????#???#?? 5,5
#.???##??? 1,5
??????.##? 1,1,3
.?.????..? 1,1,1
???#?????#?????.?.?? 1,7,1,1,1
??????????#.??#?? 1,3,1,1,4
.#????###? 1,7
??.??#...?#.?? 2,2
???????#?#?? 1,5
??#?#?..?#???? 6,1,2
?#?#????#????????? 2,3,2,2,1
????.#??#? 1,2,4
????#..??.?.?##.. 3,2,1,2
.?#?.#?.?#????###?? 3,2,9
.????#?#?#????????? 1,4,1,7
?#?..#??#??. 1,6
.?????.#????#?..#?? 1,1,1,1,3,3
???.??.?#? 2,2,2
???#?##??#?#.?..? 2,7,1,1,1
##??#??#??????#? 9,1,1,1
?#?#???#.???????. 4,1,4,1
???##??#?#.?? 1,7
??????#?????????? 2,1,1,2,2
?#?##???#?? 1,2,4
?.???##??????????? 1,14
??.?#?????#? 1,3,2
????#???#??.?.?????. 1,7,1,1,1
??#??.##?##??????# 3,8,1,1
???#??#?.???? 2,3,4
?.??#?????? 1,4
??#??#???#??##?? 3,3,1,2
???????#??#?..#?#??? 12,1,2
#?#???#????#??? 3,1,1,5
.??..?##?#.??##....? 4,2
##???#??.#????? 2,2,6
?#?????.???..??????? 5,2,3,1
???????#???#??.??.?. 2,11,1,1
?.??#???#????.. 2,3,1,1
..??..???#.???????? 2,1,5
???????....? 3,1
???#????#??#????#? 1,1,11
??.????..?#? 1,1,2,1
#?.?#?.???? 1,1,2
?#????.??.#? 1,1,1,2
???#?#???#?? 4,1,1
???##?.?#..?.# 5,2,1,1
???##.?#???##??#??? 5,10,1
???#??##.??##.??? 5,2,1
.?##?????..?##???.? 8,2
#??#.?.??#.? 2,1,2,1
.?#?#?.##.#? 4,2,1
??##?.???#?#??#??#? 3,9
.?.??###??#.#?.? 1,4,1,2,1
??#?.?????#? 1,1,1,1
.?#??#?##..?#??#.# 8,5,1
?????#?#???.#.?.?? 1,2,6,1,1,1
.???????#. 3,1
#?#.?????????#?? 3,3,2,2
.????..#?# 1,3
?#????.#.?###??.??? 5,1,5,1,1
????#..#?#??#.??..? 2,1,3,2,1,1
????##??.#?# 3,3
#???#?????????##?## 1,1,2,3,3,2
#????????? 1,2,2
..?#?????????. 8,2
.##..???#???#?.# 2,1,1,4,1
.???.??????.?#?.??? 3,3,3,1
?.#??????#? 1,1,4
?#??.????#?##?? 1,3,4
.??????.??? 5,1
??.??.#.??#? 1,1,3
?#?????????..??????? 9,1
.??#?#???????????# 5,1,1,2,2
##???.??#??# 5,5
???.?????# 2,2
?#???????????#?? 5,4
?#???#.???#.?###??#. 2,2,1,2,3,2
#?.??????? 1,1,3
#???#????.#?.#? 8,2,1
?#.#.??????#??.???? 1,1,1,4,2,1
.#?#??.?????????? 3,1,1,1,2
??????#?????#???? 1,3,7
????.??.?##.. 2,1,1,2
..?#???.??.??.??#??? 4,5
?###????##??#??#. 5,10
?#?#????????.??? 10,1
???#??#?.?#.??? 6,2,1
???????##??#?????.# 1,1,6,1,1
??????#.?? 1,1,1
?##??##.?#???. 6,3
.?#??#.??#?#??.? 1,1,4,1,1
???????????????#.? 12,3
.??#?###?.#????#?. 6,4,1
#?????????? 4,1
?????.????.??. 1,3,2
??.????###?#.???. 2,7,1
?.???????.???#??#? 1,6,1,1,3
???..????##??#?.?? 1,10
?????.????????? 2,7
???.????????##???.? 2,11,1
#?#...???????#??#??? 3,3,7
?#.?#???#? 1,2,3
??#?.?????#.??? 3,1,1
???#??????? 1,3
?????????#?#?.??.?. 11,1
?#?????????.????.??? 11,4,2
??????????????#.? 2,1,2,1,2
?#.##?????#?#?# 1,4,2,1,1
?.??.???????#???#.? 2,1,6,1
??#????#?#.????. 3,3,1,1
?.??.?.??#?.?.? 2,1
??????#??? 1,2,4
#..###???#. 1,7
????..#.???.? 4,1,3,1
??.???##?. 1,4
???#.???#???.?????? 2,1,1,2,5
?????#?##? 1,6
##?##?#?##????????. 10,2,1
.?..????#???? 1,1,5,1
?#???#?.?????.#. 2,1,1,3,1
#?????..?.#?? 5,1,1,1
????????????? 1,3,2
.?.???##??????? 1,10,1
.?#?..???.###? 2,1,3
?..??##?..? 1,4
#?.???##?????.??.? 1,1,6,1,1
###??#???.????# 3,1,1,1,1
???.#???.#? 1,2,1
???.?#?#??????. 5,1
?????????#?#???? 3,5,1
??????#????##?. 1,7
??#????#????#??????? 2,15
?????##??#?????#? 6,7
??###?.??? 3,1
??.##????#? 1,2,2
??#??.?????? 2,2
??#??????.???#####.? 3,1,7
??#?.?..?.? 2,1
?.??.#?#?#????.?? 1,2,6,1,2
#?#.?..#.?????. 3,1,1,2,1
??#???.???? 5,1
##?????.?.??????.? 7,2,2,1
.???#?#???? 1,8
.?##?####.?.????? 8,4
.?...##??#????????. 1,11
??#..?#??? 1,1,1
.?.??.???#?????#??#. 1,1,1,11
?#???#???.#????? 2,5,1,1,1
.?#?.?.?##??.? 3,3,1
.??#?.???#??? 1,4
?#????#???#?... 2,2,2
.?.?#?????#???.. 1,3,1,1,1
#???.?#??# 1,1,5
?????????## 1,1,5
????#??.####?? 1,4,4,1
.??????#?#???????? 1,1,11
?.?#.?#?.??????. 1,1,1,5
???#?.?.????????#?? 2,1,1,1,2,5
##????#????. 8,1
#..###??#?#?# 1,10
?##.??.#.???##.? 2,1,1,4
#?##?#???? 7,1
???#????#???## 5,1,4
?.?#?.???#? 2,1,1
..???????? 2,2
???.??#???????? 1,3,6
????.?#??#????##?#?. 1,1,2,1,2,4
???????.?..??##???#? 1,2,1,4,1,1
.?#????.???##????#?? 3,2,9
?#??#.??#????????? 3,1,2,1,3
???#??#..?? 4,1
?.??#?..?. 3,1
???????#?#?#?##?#? 3,4,1,5
#?.??..????##?###? 2,1,1,8
?..?####?#??#?.?? 1,10,1
#?...???..? 2,2
??????#?????? 1,1,7
????????????#? 1,2,6
.?.#??????#?#??? 1,2,2,7
???##??#?#.????#???? 10,2,1,3
.??#??#.???#? 6,5
####????.#?#?.?.#?#? 4,1,3,1,2
?.????.#?.?##?#? 1,3,1,5
.??????????#.?#??. 2,2,2
???##????#?..?. 5,2,1
.????#.?#?#???? 1,3,7
??.??????? 1,2,1
#?##?????????##?? 4,1,1,1,4
??#?#?.???? 1,3,1
?..#???#?#??. 1,3,5
?#????????#???? 2,11
#?.#?.#?#?##..???#?? 1,2,6,5
??#??????.??.??#. 1,1,5,1,3
?.????????#? 1,1,1,1
??##?.???#?. 4,4
?#??????.?.?#?. 1,2,2,2
??.#?#?????...#? 1,1,1,2,2
...?????.?##??.? 2,3
..??##????. 1,4,1
????.?..???#??#?? 1,1,1,7
.?.??????#. 2,4
..???..#.? 1,1
?.?????????#.?? 2,2
??.#.?#?.?#?#?????? 1,1,2,6,1,1
???#?????#??? 1,7
?##?##.???#?????.?? 6,3,4,1
??###..????#??#..?#? 4,4,2,2
#..????#?#?#?####.? 1,1,1,1,8,1
???#?#?###?#?.?##?.? 9,3
.###?#?#???.??.??? 9,1
??###???#??#? 7,4
.#?.??#????? 2,1,1,3
?#???#?#?.??##???#?. 8,1,3,3
???????#?. 1,1,1
##.?##?????????? 2,10
#.#?.#????#? 1,1,1,1
.#.?????????#? 1,2,2,1
.#????.##? 1,2,2
??????#???##? 1,3,3
?#?#?.?#??.??? 4,3,1
?.#??#?#?#???#?#??? 1,16
?.#???#?#???.##????? 2,2,4,4,1
????.??#???#??.???#? 1,2,1,1,1,4
?##???????#???#??.? 3,1,2,4,1
?#???.????#????.# 4,3,1,1
???#????.???.?#??? 1,3,1,1,1,3
???#??..#?.#??? 4,1,1,1
.?#????.?.?## 1,1,3
?.??##???#?.?#??.? 6,1
?.###???#????#??? 1,4,4,2,1
?.??##?.?#???##?. 1,2,1,5
##??????#??#.???##?? 3,6,6
#?.????##?#??#? 1,2,8
???###.???#?#?#? 3,6
#?.?.??#???#???# 2,1,5,1,2
#?????#?????#??#? 1,1,11
??????..?#? 2,1
????.??????.??????? 1,1,1,2,4
???????#???#?. 2,8
??.????#?? 1,6
?#.?????#.?#????.#?. 2,1,3,5,1
?#?#??.?????#???? 4,7
.??????.???????# 1,4
#?#.???.?#? 3,1,2
????#?..#? 1,2,2
#????.#?#?.?????? 1,1,4,1,1
?#????#?#??. 2,4
?.#???????? 3,1,1
??????#..???#??? 1,1,5
????#??#???????? 6,2,1,1
.#???#?#.##? 5,1,2
????.??????.?.#??# 2,5,4
??????#???#?.??#. 7,1,2,1,1
????#???.#? 6,1
?.??#?#????#??????? 5,5
????#.##??.?? 2,1,2,1
##??###?#???# 10,1
?#????.???????##.# 3,1,1,1,5,1
###??#?.??????? 7,3
??#?##?..???? 4,1
?????###???#?..? 9,2,1
???#????#?. 6,2
???##???#?.?###??. 3,2,6
????#???#?##???? 2,8
.??.????... 1,1
??#..?????#.##?#??# 2,3,1,2,4
.??????##?.? 2,2
????#?.??.? 1,1,2
???#??.???##? 4,1,1,2
??.?##.#?.?#?? 2,3,1,4
?????.?#??# 1,2,1
???.??##??#? 2,2,1
?.?#??##?##?#..?.?#? 5,4,2
.#?#..?..?????.#? 3,1,4,1
?#???#??????#?????#? 3,3,1,9
#?#?#???????#?.#.?# 1,3,4,2,1,1
???.????#??.? 2,5
???##????#?.#. 3,3,1
?????#?????. 1,2,2
.???#???##?#?#?.?#.# 1,10,1,1
?##?????###??.?..?. 4,6,1,1
.??#?.???.? 1,2,1
???##??????##??#?#? 4,2,2,4
#????#?#?? 1,1,4
????#?????? 4,4
????#??..????#?..? 1,1,1,3,1,1
?.??????.?#?# 1,1,1,4
?#?????????##. 4,5
?.###????#???? 6,1,1
???????#?#???#?? 1,2,8,1
???????#?#? 1,3
?###?#??????#??????# 10,2,2,1
?.????.??? 1,1,2
.#?##????.?? 4,1
??.??####??#.??# 9,2
?.?.???.???#?# 1,1,4,1
#?#?#?.#.?#??? 5,1,1,2
??#?#?##???.#?#??#?? 1,9,1,1,1,1
.???#??#??#??? 4,4,1
???#?????.?.??????? 1,7,1,2,1,1
?????###.#??#??.?.# 3,4,1,2,1,1
?#??????#?????##??## 10,7
??????????#???????? 7,4,2
??#????#???? 7,1
?.?#??.??? 1,2,2
????..????????????? 2,3,4,2
.??.???.??#? 1,1,1
#????.??#?.???. 5,3,1,1
???#?#??.?#???#?.#? 3,1,1,6,1
.?????#????###?????? 12,2
#?????#??????? 2,4,3
?###??#???.#. 3,2,1
??.????.??.?????##? 1,2,1,1,8
?????.???? 1,2
.?..?????. 1,1,1
?.?####?#?#???????.? 1,9,1,1,2
.????????????#??. 2,8
?##???.???##??#? 5,7
??????###.?#?? 1,1,4,4
.?..?#???????? 2,2
#??#?##??#?????#.??? 11,2,1,2
.??#.????##.???? 2,1,2,1,1
#???#???.??#.???? 3,1,1,3,4
.??.???#?#?? 1,1,3
.?#??????#?? 9,1
??.?#?#???????##..? 1,13,1
.??#??#?#?????##???? 1,14,1
?#??#?#.????????? 6,2,2,1
#?#??.???????#. 5,7
????.#??#?? 1,5
?#..#??????.?#? 2,6,2
.?#...????##? 2,2,2
.##.?#?.?.?#?.?# 2,2,1,3,1
?????.??##?. 3,1,2
?#???????#????????#? 2,1,2,1,5,1
?##?.??????#? 3,1,1,2
???.??#??.#?? 5,1
.???#?#????###?#..? 4,7
#????.???#?#?.?# 1,3,4,1,1
?????#?#?.???.??.. 2,1,1,1,1,2
.#???.?.??? 4,1
.???#?#..? 1,3
.?#?###???#??? 2,4,3
?##???#??#? 2,6
????.???##?.?? 1,1,4,1
????#.???.??? 3,1,1
?.??#???#??.?#. 5,1
????.??????#???#??.. 3,7
#.???#.????#.??? 1,2,1,3,1
#?#?#????#???#?..?.? 14,1
?#..??#???#? 1,2,2
..#???.???#? 3,1,1
?.???..???.??? 3,2,1
#?#???????#??.??? 1,1,7,2
??????.??.#???.??? 1,3,1,1,1,1
?????#?#?#.????..#?? 8,2,3
.????#.???##.? 5,3
?#???.??.?# 3,1,2
?.??#???.?.? 1,1,1,1
??????...# 3,1,1
.#??#??.?#???.??? 4,1,2,1,1
???##?????????# 5,3,1
?#????????#?? 5,1,1,1
??..?#?..??.? 1,2,1,1
.##??##?#???#?#?#? 2,5,3,1,2
.??..#??.#?.??#???. 2,1,1,2,2,1
??????##?????## 2,5,4
??.??#??#????? 1,9
???#??#??.?? 1,2,2,1
#????.??????? 4,1,2,1
???##.??#?#?#.#??# 5,7,1,1
?????.?.??.?# 4,1,1,2
#??#??##.#.? 1,6,1
.?.??.?#?? 1,3
?#?.??#.???.??#???#? 3,3,2,1,2,1
??#?..??#??#???????? 2,9,1
????#????. 1,4,1
??#????.?????##?#?#? 2,2,1,5,1
.???.???#? 3,1,2
???????.??.? 2,1,1
##?###???? 7,1
?????????#?# 7,1,1
.??#??##?#????#???? 2,12
???????#?#? 1,5
??.?#????? 1,1,1
.?...#??#?#?? 1,2,1,1
?????###?????#?#.? 12,1
?#???##??## 1,8
???#??.?.??.? 2,2
.???.?.##??###?#???. 1,1,7,1,1
?#??????#????.? 4,7
????#?#????#??????? 9,1,6
??#??..#?#? 1,3,4
?.????##???#? 5,2
???#????.??????# 1,1,1,1,5
?#?#???###??#?..? 6,6
..??????.. 1,1
?.?#?.??#.?? 1,2,2,1
????..?????# 1,1,2,1
?.#??#??#.???#??# 7,1,1
??.#??.??.???##?.??? 2,1,2,6,1,1
??#?#..?.#??#?.?##?? 5,1,2,2,4
.????..???? 2,2
#???##.??.? 6,2
.#???#??.#?#?#?## 7,8
?.?..##??#? 1,5
#????????.#??? 8,2
.??.#??#???#?.?..?. 4,2
?#???????#??#?.??# 1,1,7,1
#???#??.??.???. 3,2,1,1
.???#?????.. 2,1,1,1
???????#??#?? 4,2,3
??????.?.???..??.#? 1,1,1,3,2,1
??.???#??..?? 1,5,1
????#?????.????.? 7,2,1
?.?#?#?.???#? 4,2
.???#??#?? 1,1,3
#????#???.?.??# 2,1,1,1,2
#?#??.????? 5,1,1
...#?????? 2,3
..??..???? 1,3
????##??????? 4,1
?.#??.?#?.??# 3,1,1,1
?#????#?.????? 7,1,1
?.??#??.?.??. 3,1,1
?#?#???.????. 4,4
?.?...????.. 1,4
????#?#???#?.?.# 9,1
??.?????#?.?? 1,1,3,1
?.#?.?.??. 1,1,1
?.?#??#????#???.#?? 1,2,7,3
?.??##?.?.#?.? 5,2
??#.??#??#?.??? 2,6,1
?.????#?#?#???? 1,4,6
??#???..#???###????? 1,1,11
?.???#.???.? 1,2,1,1
?.???????.?.?###???? 1,1,1,1,3,3
???##?#?.???.?????? 7,2,3
????##????? 1,4
.#?#??????#? 1,2,1,3
??#?#?.????????. 2,1,8
?.??#?.?#.??? 1,2,1,2
???#??#?#.?????? 8,5
??????#????#???? 1,13
?.????.??.?#????#?? 1,2,1,1,5
???.#?#?.. 1,4
#??????#??? 3,6
?.?###?#??..?#? 7,3
??????#?.?.?????? 2,1,1,5
?#???#.???###???? 3,1,1,5,2
?????????#?#? 1,3,1,4
?????.?????.?#??#? 3,2,4
.#??????.#..??# 1,1,1,1,3
.???#?###??????? 8,3
??#????##?..?? 9,1
.?#?#.??#?.? 2,1,3
###???.???? 4,1,3
?#.??#??## 2,2,3
??..??.?#?#?##?. 1,8
.??????????.? 3,5
??.?#?#???... 1,6
?????????.??????? 4,1,1,1,1
???##?????.???? 7,4
?##???#.?.??..?? 3,1,1,1,1
??#??#?.???.#???# 1,1,1,1,5
???#?##??.???. 7,2
?????#???? 1,2,1
#????????.??# 8,2
??##??????#?#??? 5,5
?.????????.???? 1,1,5,2,1
?.??..????? 1,2
??#??.?#?#?#????. 5,8
????#?.???????#???#? 2,3,8,3
..#???##.?????? 1,1,2,3
#????#?##?#??????? 1,1,7,1,3
#?.????????? 2,1,3
????????.?#? 1,1,2,2
.#?#??.?#???.##??? 5,5,2,1
??????????#?? 9,1
.?##?#????##? 6,3
?.??##??#????##? 1,11
???###????? 7,1
#????##??##?.. 1,8
?.??#??????????.? 5,3
#???.???#?? 4,3
.##??????#?.??. 4,1,1,2
?#??????????. 1,2,3,1
.???#?..#?.?????? 5,2
.?#??????.?#??.?#? 1,1,1,2,1,2
?#?##????#? 4,4
???????#.?????#??#. 1,1,3,1,2,1
??#?????????..???##. 4,1,2,5
.???#.???.? 3,1,1
?.?.?#?###??#??.# 1,1,6,3,1
?#???#?#??..???####? 2,7,8
.?.??????. 1,6
#?#.?#??.??.????#? 1,1,2,1,6
?.???????? 2,3
..??????#??????? 8,1
???#?????..???#?#?#. 7,8
.#??????#?#??? 1,10
???.??#.???. 3,1
.??.??#?.?...? 2,3,1,1
?.????????.###?.#? 1,1,1,1,4,2
??#?????#? 1,1,5
?..###?#???..???? 8,3
???????????##.?. 1,2,7,1
#?###.????? 5,2,1
..?????..?????.? 3,1
.?#??.?#.??????. 3,2,5
?.?#.#??.? 2,3,1
..?#????????????.? 3,2
#????#??#???????? 9,4
????????.#????#.?? 7,6,1
??????#?.??##?? 2,3,3
.????#.??? 1,1,1
?????????????#???.?? 4,8,1
.??#??????#? 3,4
?.#???#.???? 1,5,3
.?.?#??#???#???? 1,1,2,6
.??.#??.?.?#??????? 2,1
??..#.?..? 1,1,1
.#???#?.#.???.???.? 5,1,2,3
????#.????#???#..??? 2,1,3,5,1,1
.???????????#??????. 7,4,2
#??#??#.?.?.???? 7,1,1,1
.?.????#?????#?????? 5,9
????#????#???.?#??? 13,2,1
???????#?##?..# 1,4,5,1
??#???.???#?...## 3,1,3,2
?????.??.???.? 2,1,1,1
#??#??????? 7,1
??.#???#?????? 1,2,8
"""
}
